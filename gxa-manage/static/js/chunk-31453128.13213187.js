(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-31453128"],{"1f72":function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return l})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return s}));n("d3b7");var a=n("b775"),i=function(){return new Promise((function(e,t){Object(a["a"])({url:"/onlinejudge/admin/manage/user/gets/userlist",method:"get"}).then((function(n){0!==n.code&&t(n.msg),e(n.data)}))}))},r=function(e){return new Promise((function(t,n){Object(a["a"])({url:"/onlinejudge/admin/manage/user/add",method:"post",data:JSON.stringify(e)}).then((function(e){0!==e.code&&n(e.msg),t(e.msg)}))}))},l=function(e){return new Promise((function(t,n){Object(a["a"])({url:"/onlinejudge/admin/manage/user/delete",method:"delete",data:JSON.stringify({delete_id:e.id})}).then((function(e){0!==e.code&&n(e.msg),t(e)}))}))},o=function(e,t){return new Promise((function(n,i){Object(a["a"])({url:"/onlinejudge/admin/manage/user/update",method:"post",data:JSON.stringify({update_id:e,email:t})}).then((function(e){0!==e.code&&i(e.msg),n(e)}))}))},s=function(e){return new Promise((function(t,n){Object(a["a"])({url:"/onlinejudge/admin/manage/user/update",method:"post",data:JSON.stringify(e)}).then((function(e){0!==e.code&&n(e.msg),t(e)}))}))}},"302f":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("integral-list",{attrs:{list:e.showList},on:{search:e.search,updateIntegral:e.updateIntegral}}),n("pages",{attrs:{"total-pages":e.totalPages},on:{pageChange:e.pageChange}}),n("update-integral",{ref:"updateIntegral",attrs:{ruleform:e.singleData,uid:e.activeClickUserId},on:{updateIntegral:e.updateIntegralSubmit}})],1)},i=[],r=(n("fb6a"),n("4de4"),n("caad"),n("2532"),n("bf19"),n("ac1f"),n("5319"),n("841c"),n("d3b7"),n("159b"),n("b775")),l=function(){return new Promise((function(e,t){Object(r["a"])({url:"/onlinejudge/admin/manage/user/integral/integrallist",method:"get"}).then((function(t){var n=[];t.data.forEach((function(e){n.push({CreatedAt:e.CreatedAt,UpdatedAt:e.UpdatedAt,DeletedAt:e.DeletedAt,ID:e.ID,Value:e.Value,UserID:e.UserID,ConsumptionValue:e.ConsumptionValue})})),e(n)}))}))},o=function(e){return new Promise((function(t,n){Object(r["a"])({url:"/onlinejudge/admin/manage/user/integral/set",method:"post",data:JSON.stringify(e)}).then((function(e){0!==e.code&&n(e.msg),t(e.msg)}))}))},s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-table",{attrs:{data:e.list,stripe:""}},[n("el-table-column",{attrs:{align:"center",label:"ID",prop:"ID",width:"80",fixed:""}}),n("el-table-column",{attrs:{align:"center",label:"总积分值",prop:"Value",width:"150"}}),n("el-table-column",{attrs:{align:"center",label:"已兑换积分值",prop:"ConsumptionValue",width:"150"}}),n("el-table-column",{attrs:{align:"center",label:"更新时间",prop:"UpdatedAt",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",{staticStyle:{"margin-left":"10px"},attrs:{type:"date"}},[e._v(e._s(t.row.UpdatedAt))])]}}])}),n("el-table-column",{attrs:{align:"center",label:"用户",width:"200",prop:"username"}}),n("el-table-column",{attrs:{align:"right","min-width":"300"},scopedSlots:e._u([{key:"header",fn:function(t){return[n("div",[n("el-input",{staticStyle:{width:"250px"},attrs:{"prefix-icon":"el-icon-search",placeholder:"输入关键字搜索",clearable:""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),e._e()]}},{key:"default",fn:function(t){return[n("el-button",{attrs:{size:"medium",circle:"",icon:"el-icon-edit",type:"warning"},on:{click:function(n){return e.updateIntegral(t.$index,t.row)}}})]}}])})],1)},u=[],c={props:{list:{type:Array,default:function(){return[]}}},data:function(){return{value:!0,search:""}},watch:{search:function(e,t){this.$emit("search",e)}},methods:{updateIntegral:function(e,t){this.$emit("updateIntegral",t)}}},d=c,f=n("2877"),m=Object(f["a"])(d,s,u,!1,null,"8628fb8e",null),g=m.exports,h=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-pagination",{ref:"page",attrs:{background:"","hide-on-single-page":!0,layout:"prev, pager, next",total:e.totalPages},on:{"current-change":e.handleCurrentChange}})},p=[],b=(n("a9e3"),{props:{totalPages:{type:Number,default:0}},methods:{handleCurrentChange:function(e){this.$emit("pageChange",e)}}}),v=b,I=(n("e976"),Object(f["a"])(v,h,p,!1,null,"7f836ea6",null)),w=I.exports,y=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{attrs:{title:"编辑用户积分",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[n("el-form",{attrs:{model:e.form}},[n("el-form-item",{attrs:{label:"总积分值:","label-width":"100px"}},[n("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.value,callback:function(t){e.$set(e.form,"value",t)},expression:"form.value"}})],1),n("el-form-item",{attrs:{label:"已兑换积分值:","label-width":"120px"}},[n("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.consumption_value,callback:function(t){e.$set(e.form,"consumption_value",t)},expression:"form.consumption_value"}})],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("确 定")])],1)],1)},_=[],P={props:{ruleform:{type:Object,default:function(){return{}}}},data:function(){return{dialogFormVisible:!1,form:{user_id:0,value:"",consumption_value:""},formLabelWidth:"100px"}},watch:{ruleform:function(e,t){this.form.user_id=e.UserID,this.form.value=e.Value,this.form.consumption_value=e.ConsumptionValue}},methods:{submit:function(){this.form.value=parseInt(this.form.value),this.form.consumption_value=parseInt(this.form.consumption_value),this.$emit("updateIntegral",this.form),this.dialogFormVisible=!1}}},S=P,L=Object(f["a"])(S,y,_,!1,null,"cbdfad66",null),O=L.exports,j=n("1f72"),C={components:{IntegralList:g,Pages:w,UpdateIntegral:O},data:function(){return{singleData:{},everyPageShowItemNumber:8,allIntegralList:[],totalPages:0,activePage:1,searchList:[],activeClickUserId:null}},computed:{showList:function(){return this.searchList.slice((this.activePage-1)*this.everyPageShowItemNumber,(this.activePage-1)*this.everyPageShowItemNumber+this.everyPageShowItemNumber)}},created:function(){this.getIntegralList()},methods:{search:function(e){this.searchList=this.allIntegralList.filter((function(t){return!(""!==e&&!t.username.includes(e))})),this.totalPages=10*Math.ceil(this.searchList.length/this.everyPageShowItemNumber)},updateIntegral:function(e){this.singleData=e,this.activeClickUserId=e.ID,this.$refs.updateIntegral.dialogFormVisible=!0},updateIntegralSubmit:function(e){var t=this;o(e).then((function(e){t.getIntegralList(),t.$message({type:"success",message:e})})).catch((function(e){t.$message({type:"warning",message:e.msg})}))},pageChange:function(e){this.activePage=e},getIntegralList:function(){var e=this;l().then((function(t){e.totalPages=10*Math.ceil(t.length/e.everyPageShowItemNumber),e.allIntegralList=t,Object(j["c"])().then((function(t){for(var n=0;n<e.allIntegralList.length;n++){var a=new Date(e.allIntegralList[n].UpdatedAt).toJSON();e.allIntegralList[n].UpdatedAt=new Date(+new Date(a)).toISOString().replace(/T/g," ").replace(/\.[\d]{3}Z/,"");for(var i=0;i<t.length;i++)e.allIntegralList[n].UserID===t[i].id&&(e.allIntegralList[n].username=t[i].user_name)}})),e.search("")})).catch((function(t){e.$message({type:"warning",message:t})}))}}},D=C,k=Object(f["a"])(D,a,i,!1,null,"5cef3000",null);t["default"]=k.exports},"70f0":function(e,t,n){},bf19:function(e,t,n){"use strict";var a=n("23e7");a({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return URL.prototype.toString.call(this)}})},e976:function(e,t,n){"use strict";n("70f0")}}]);